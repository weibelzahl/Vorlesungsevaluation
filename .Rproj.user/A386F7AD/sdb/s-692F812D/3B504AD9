{
    "collab_server" : "",
    "contents" : "\\documentclass{article}\n\\usepackage[T1]{fontenc}\n\\usepackage[utf8]{inputenc}\n\\usepackage{geometry}\n\\usepackage{fancyhdr}\n\\renewcommand{\\familydefault}{\\sfdefault}\n\\geometry{a4paper, total={210mm,297mm}, left=20mm, right=20mm, top=15mm, tmargin=39mm, headheight=70mm, bottom=20mm}\n\\pagestyle{fancy}\n\\fancyhead{} \n\\fancyhead[RO,RE]{\\includegraphics{img/pfh_logo3.png}}\n\\fancyfoot{} \n\\fancyfoot[RO,RE]{\\thepage}\n\\thispagestyle{fancy}\n\\renewcommand{\\familydefault}{\\sfdefault}\n\n<<include=FALSE>>=\nmodulnamen <- data.frame(read.csv(\"mn.csv\", sep=\";\", encoding = \"UTF-8\"))\nmodulnamen$Studiengang <- factor(modulnamen$Studiengang)\nitemlevels <- read.csv2(\"itemlevels.csv\", header = TRUE, sep = \";\", stringsAsFactors = TRUE)\ntitles <- read.csv2(\"cover_title.csv\", header = TRUE, sep = \";\", encoding = \"UTF-8\")\n\n        studiengaenge <- list(\n          BScGM1 = \"Campusstudiengang\\\\\\\\ B.Sc. General Management\\\\\\\\ 1. Semester\",\n          BScGM1ABWL = \"Campusstudiengang\\\\\\\\ B.Sc. General Management\\\\\\\\1. Semester\\\\\\\\ (nur Mathematik und EinfÃ¼hrung in die BWL)\",\n          BScGM2 = \"Campusstudiengang\\\\\\\\ B.Sc. General Management\\\\\\\\ 2. Semester\",\n          BScGM3 = \"Campusstudiengang\\\\\\\\ B.Sc. General Management\\\\\\\\ 3. Semester\",\n          BScGM4 = \"Campusstudiengang\\\\\\\\ B.Sc. General Management\\\\\\\\ 4. Semester\",\n          BScGM5 = \"Campusstudiengang\\\\\\\\ B.Sc. General Management\\\\\\\\ 5. Semester\",\n          BScPsy1 = \"Campusstudiengang\\\\\\\\ B.Sc. Psychologie/Wirtschaftspsychologie\\\\\\\\ 1. Semester\",\n          BScPsy2 = \"Campusstudiengang\\\\\\\\ B.Sc. Psychologie/Wirtschaftspsychologie\\\\\\\\ 2. Semester\",\n          BScPsy3 = \"Campusstudiengang\\\\\\\\ B.Sc. Psychologie/Wirtschaftspsychologie\\\\\\\\ 3. Semester\",\n          BScPsy4 = \"Campusstudiengang\\\\\\\\ B.Sc. Psychologie/Wirtschaftspsychologie\\\\\\\\ 4. Semester\",\n          BScPsy5 = \"Campusstudiengang\\\\\\\\ B.Sc. Psychologie/Wirtschaftspsychologie\\\\\\\\ 5. Semester\",\n          BScPsy6 = \"Campusstudiengang\\\\\\\\ B.Sc. Psychologie/Wirtschaftspsychologie\\\\\\\\ 6. Semester\",\n          MAGMWS = \"Campusstudiengang\\\\\\\\ M.Sc. General Management\\\\\\\\ Wintersemester\",\n          MAGM = \"Campusstudiengang\\\\\\\\ M.Sc. General Management\")\n        \n        studiengang_id <- unlist(strsplit(studiengang_modul_id, \"_\"))[1]\n        studiengang <- studiengaenge[[studiengang_id]]\n        if(nrow(subset(titles, id==studiengang_modul_id, select = title))>0){\n          title <- paste(\"Campus\\\\\\\\\", titles[titles$id==studiengang_modul_id, 2])\n        }else{\n          title <- studiengang\n        }\n\n        \n        offsets <- list(BScGM1 = 9, BScGM1ABWL = 9, BScGM2 = 9, BScGM3 = 9, BScGM4 = 9, BScGM5 = 9, BScPsy1 = 9, BScPsy2 = 9, BScPsy3 = 9, BScPsy4 = 9, BScPsy5 = 9, BScPsy6 = 9, MAGM = 10, MAGMWS = 10)\n\n        dozentenwahl <- FALSE\n        dozent <- \"\"\n        \n        \n@\n\n\n\n\\begin{document}\n\\title{Evaluation der Vorlesungen\\\\ \n\\Sexpr{title}\n}\n\\date{\n\\Sexpr{datum}\n}\n\n\\author{}\n\\maketitle\n\\renewcommand*\\contentsname{Vorlesungen}\n\\setcounter{tocdepth}{1}\n\\tableofcontents\n\n<<run-all, include=FALSE>>=\n# Dateiname\n  data <-\n  read.csv(\n    inFile$datapath, quote = \"'\\\"\", na.strings = c(\"\", \"\\\"\\\"\"), encoding = \"UTF-8\"\n  )\n#data <-\n#  read.csv(\n#    \"data/BScGM1.csv\", quote = \"'\\\"\", na.strings = #c(\"\", \"\\\"\\\"\"), stringsAsFactors =\n#      FALSE, encoding = \"UTF-8\"\n#  )\n\nsource(\"generic_syntax_file.r\", encoding = \"UTF-8\", local = TRUE)\n\n# select complete answers only\ndata <- data[!is.na(data$submitdate),]\n# write.table(head(data[1:8,c(1:3,9:15)]), file = \"logger.csv\", append = TRUE, sep=\",\")\nfragen <- 25 # questions per module\noffset <- offsets[[studiengang_id]] # col number of first module question\nspalten <- ncol(data)\nmodule <- (spalten - offset + 1) / fragen\n# write.table(c(\"module: \", module), file = \"logger.csv\", append = TRUE, sep=\",\")\n\nlibrary(knitr)\nout = NULL\n\n# if \"Alle\" was selected, analyse all modules\nalle_dozenten <- length(unlist(strsplit(studiengang_modul_id, \"_\"))) == 1\n#message(paste(\"Hi:\", alle_dozenten))  \n#print(paste(\"Hi:\", alle_dozenten))  \n\n# analysis per module\n  for (i in 1:module) {\n    #for (i in 1:3) {\n    \n    # only execute knitting if \"all\" or if module matches   \n    if(alle_dozenten || ((unlist(strsplit(studiengang_modul_id, \"_\")))[2] == i)){  \n      # special case BScGM1: 2 modules already evaluated\n#      if(i>1 && studiengang_id == \"BScGM1\"){\n#        offset <- 11\n#      }\n      # special case BScGM5 Vertiefungsfach\n      if(i>4 && studiengang_id == \"BScGM3\"){\n        offset <- 10\n      }\n      # special case BScGM5 Vertiefungsfach\n      if(i>4 && studiengang_id == \"BScGM5\"){\n        offset <- 16\n      }\n      # special case BScGM5 Vertiefungsfach\n      if(i>8 && studiengang_id == \"BScPsy3\"){\n        offset <- 13\n      }\n      # special case BScGM5 Vertiefungsfach\n      if(i>18 && studiengang_id == \"BScPsy3\"){\n        offset <- 4\n      }\n      # 2nd special case MAGM: Vertiefungswahl\n      if(i>6 && studiengang_id == \"MAGM\"){\n        offset <- 16\n      }\n      # 2nd special case MAGM: Vertiefungswahl\n      if(i>8 && studiengang_id == \"MAGMWS\"){\n        offset <- 16\n      }\n      start <- ((i-1)*fragen)+offset\n      # write.table(c(\"start\", start), file = \"logger.csv\", append = TRUE, sep=\",\")\n      modulname <- modulnamen$Veranstaltung[modulnamen$Studiengang==studiengang_id][i]\n      dozent <- modulnamen$Dozent[modulnamen$Studiengang==studiengang_id][i]\n      dozentenwahl <- modulnamen$Dozentenwahl[modulnamen$Studiengang==studiengang_id][i]\n      \n      source(\"label_items.r\", encoding = \"UTF-8\", local = TRUE)\n\n            \n      studiengangsdaten <- data[,start:(start+fragen-1)]\n      # write.table(head(studiengangsdaten[1:5,1:5]), file = \"logger.csv\", append = TRUE, sep=\",\")\n     if((dozentenwahl == 1) && (!alle_dozenten)){\n        dozent_id <- as.integer((unlist(strsplit(studiengang_modul_id, \"_\")))[3])\n        dozent_factor <- paste(\"A\", dozent_id, sep=\"\")\n        colnames(studiengangsdaten) <- c(\"k1\", \"k1a_SQ001\",\"k1a_SQ002\", \"k1a_SQ003\", \"k1a_SQ004\", \"k1a_SQ005\", \"k1b_SQ001\", \"k1b_SQ002\", \"k1b_SQ003\", \"k1b_SQ004\", \"k1b_SQ005\", \"k1b_SQ006\", \"k1b_SQ007\", \"k1b_SQ008\", \"k1b_SQ009\", \"k1c_SQ001\", \"k1c_SQ002\", \"k1c_SQ003\", \"k1c_SQ004\", \"k1d_SQ001\", \"k1d_SQ002\", \"k1e_SQ001\", \"k1f\", \"k1fa\", \"k1fb\")\n\n        studiengangsdaten <- studiengangsdaten[studiengangsdaten$k1 == dozent_factor,]\n        dozent <- (unlist(strsplit(as.character(dozent), \", \")))[dozent_id]\n      }\n      studiengangsdaten <- studiengangsdaten[!is.na(studiengangsdaten[,2]),]\n      if(nrow(studiengangsdaten)==0){\n        out = c(out, knit_child('keineAntworten.rnw'))\n      }else{\n        colnames(studiengangsdaten) <- c(\"k1\", \"k1a_SQ001\",\"k1a_SQ002\", \"k1a_SQ003\", \"k1a_SQ004\", \"k1a_SQ005\", \"k1b_SQ001\", \"k1b_SQ002\", \"k1b_SQ003\", \"k1b_SQ004\", \"k1b_SQ005\", \"k1b_SQ006\", \"k1b_SQ007\", \"k1b_SQ008\", \"k1b_SQ009\", \"k1c_SQ001\", \"k1c_SQ002\", \"k1c_SQ003\", \"k1c_SQ004\", \"k1d_SQ001\", \"k1d_SQ002\", \"k1e_SQ001\", \"k1f\", \"k1fa\", \"k1fb\")\n        for (c in 1:21){\n          factor(studiengangsdaten[,c], levels = levels(data[,offset+c-1]))\n        }\n        \n        out = c(out, knit_child('modulanalyse.rnw'))\n    }\n  }\n}\n  \n@\n\n%\\Sexpr{paste(mydebugger, collapse = '\\n ')}\n\n\\Sexpr{paste(out, collapse = '\\n ')}\n\\end{document}\n",
    "created" : 1489919404569.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1501115487",
    "id" : "3B504AD9",
    "lastKnownWriteTime" : 1491060913,
    "last_content_update" : 1491060913039,
    "path" : "~/GitHub/Vorlesungsevaluation/generic_vorlesung_mini.rnw",
    "project_path" : "generic_vorlesung_mini.rnw",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "sweave"
}